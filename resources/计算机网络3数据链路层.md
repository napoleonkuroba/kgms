# 第三章 数据链路层

## 3.1 <font color=#3CB371 title='0,18'>数据链路层的功能</font> P62

### 其主要作用是加强物理层传输原始比特流的功能，将物理层提供的可能出错的物理连接改造为逻辑上无差错的数据链路，使之对网络层表现为一条无差错的链路

### 3.1.1<font color=#3CB371 title='0,3'>为网络层提供服务</font> P63

> <font color=#239080 title='-1,2'>无确认的无连接服务</font>
>
> <font color=#239080 title='-2,1'>有确认的无连接服务</font>
>
> <font color=#239080 title='-3,0'>有确认的面向连接的服务</font>

### 3.1.2 <font color=#3CB371 title='0,1'>链路管理</font> P63

#### 数据链路层连接的建立、维持和释放的过程称为链路管理，它主要用于面向连接的服务

### 3.1.3 <font color=#3CB371 title='0,5'>帧定界、帧同步与透明传输</font> P63

> 帧长等于数据部分的长度加上首部和尾部的长度
>
> 首部和尾部包含有很多控制信息，它们的一个重要作用是确定帧的界限，即帧定界
>
> <font color=#800000 title='0,0'>HDLC</font> 协议中，用标识位F（01111110）来标识帧的开始和结束
>
> 每种数据链路层协议都规定了帧的数据部分长度上限——最大传送单元（ <font color=#800000 title='0,0'>MTU</font> ）
>
> 如果在数据中恰好出现与帧界定符相同的比特组合，需要采取有效措施解决误认结束的问题，即 <font color=#239080 title='0,0'>透明传输</font> ，不管所传数据是什么比特组合，都应当能够传送

### 3.1.4 <font color=#239080 title='0,0'>流量控制</font> P64

### 3.1.5 <font color=#239080 title='0,3'>差错控制</font> P64

> 通常可分为位错和帧错
>
> > <font color=#3CB371 title='0,0'>位错</font> 指帧中某些位出现差错，通常采用 <font color=#239080 title='0,0'>循环冗余校验</font> <font color=#800000 title='0,0'>CRC</font> 通过 <font color=#239080 title='0,0'>自动重传请求</font> <font color=#800000 title='0,0'>ARQ</font> 来重传出错的帧。这种差错控制法成为 <font color=#3CB371 title='0,0'>ARQ法</font> ，只需返回很少的控制信息就可有效的确认所发数据帧是否被正确接收
> >
> > <font color=#3CB371 title='0,0'>帧错</font> 指帧的丢失、重复或失序等



## 3.2 <font color=#3CB371 title='0,13'>组帧</font> P65

### 3.2.1 <font color=#3CB371 title='0,2'>字符计数法</font>  P66

> 在帧头部使用一个计数字段来表明帧内字符数从而确定帧结束的位置
>
> 如果计数字段出错，就失去了帧边界划分的依据，收发双方将失去同步

### 3.2.2 <font color=#3CB371 title='0,1'>字符填充的首尾定界符法</font> P67

> 使用特定字符来界定一帧的开始与结束，在特殊字符前面填充转义字符加以区分，以实现透明传输

### 3.2.3 <font color=#3CB371 title='0,2'>零比特填充的首尾标志法</font> P67

> 允许数据帧包含任意个数的比特，也允许每个字符的编码包含任意个数的比特；遇到5个连续的“1”，在其后插入“0”
>
> 容易硬件实现，性能优于字符填充法

### 3.2.4 <font color=#3CB371 title='0,3'>违规编码法</font> P67

> 例如曼彻斯特编码方法将数据比特“1”编码成“高-低”电平对，“0”编码成“低-高”电平对，而“高-高”和“低-低”在数据比特中是违规的。可以借用违规序列界定帧的开始和终止
>
> 在物理层进行比特编码时通常采用
>
> 不需要任何填充技术，但只适用于采用冗余编码的特殊编码环境

<font color=#FF0000 title='0,0'>目前常用的组帧方法是比特填充法和违规编码法</font>



## 3.3 <font color=#3CB371 title='0,7'>差错控制</font>

> ### 编码技术进行差错控制主要有两类：<font color=#239080 title='0,0'>自动重传请求</font> <font color=#800000 title='0,0'>ARQ</font> 和 <font color=#239080 title='0,0'>向前纠错请求</font> <font color=#800000 title='0,0'>FEC</font>
>
> ### 差错控制又可分为 <font color=#239080 title='0,0'>检错编码</font> 和 <font color=#239080 title='0,0'>纠错编码</font>

### 3.3.1 <font color=#3CB371 title='0,3'>检错编码</font> P69

> <font color=#239080 title='0,0'>奇偶校验码</font> P69
>
> <font color=#239080 title='0,0'>循环冗余码</font> <font color=#800000 title='0,0'>CRC</font> P69
>
> <font color=#FF0000 title='0,0'>循环冗余码具有纠错功能，但数据链路层只用了检错功能，检测出错直接丢弃</font>

### 3.3.2 <font color=#3CB371 title='0,0'>检错编码 海明码</font> P69



## 3.4 流量控制与可靠传输机制

### 3.4.1 <font color=#3CB371 title='0,19'>流量控制、可靠传输与滑动窗口机制</font> P73

> 流量控制涉及对链路上帧的发送速率的控制，以使接收方有足够的缓冲空间接收每个帧
>
> 基本方法是由接收方控制发送方发送数据的速率，常见的方式有：停止-等待协议和滑动窗口协议
>
> > <font color=#3CB371 title='0,1'>停止-等待流量控制基本原理</font>
> >
> > > 发送方每发送一帧，都要等待接收方的应答信号，之后才能发送下一帧，传输效率很低
> >
> > <font color=#3CB371 title='0,7'>滑动窗口流量控制基本原理</font>
> >
> > > 任意时刻发送方都维持一组连续的允许发送的帧的序号，称为 <font color=#3CB371 title='0,6'>发送窗口</font> ；接收方也维持一组连续的允许接收帧的序号，称为 <font color=#3CB371 title='0,6'>接收窗口</font> ，若接收方收到的数据帧落在接收窗口外，一律丢弃
> > >
> > > * 只有接收窗口向前滑动时，发送窗口才有可能滑动
> > >
> > > * > <font color=#239080 title='0,0'>停止等待协议</font> 发送窗口=1；接收窗口=1
> > >   >
> > >   > <font color=#239080 title='0,0'>后退N帧协议</font>  发送窗口>1；接收窗口=1
> > >   >
> > >   > <font color=#239080 title='0,0'>选择重传协议</font> 发送窗口>1；接收窗口>1
> > >
> > > * 接收窗口=1时，可保证帧的有序接收
> > >
> > > * 数据链路层的滑动窗口协议中，窗口大小在传输过程是固定的
> >
> > <font color=#3CB371 title='0,6'>可靠传输机制</font>
> >
> > > 数据链路层的可靠传输通常使用确认和超时重传两种机制完成；有些情况为了提高传输效率，将确认捎带在一个回复帧中，称为<font color=#3CB371 title='0,0'>捎带确认</font>
> > >
> > > > <font color=#3CB371 title='0,4'>自动重传请求</font> <font color=#800000 title='0,4'>ARQ</font> 通过接收方请求发送方重传出错的数据帧来恢复出错的帧
> > > >
> > > > > <font color=#239080 title='-1,3'>停止-等待 ARQ</font>
> > > > >
> > > > > <font color=#239080 title='-2,2'>后退N帧 ARQ</font>
> > > > >
> > > > > <font color=#239080 title='-3,1'>选择重传 ARQ</font>
> > > > >
> > > > > 后两种是滑动窗口技术与请求重发技术的结合，当窗口尺寸足够大时，帧在线上可以连续流动，因此又称为连续ARQ协议

### 3.4.2 <font color=#3CB371 title='0,3'>单帧滑动窗口与停止等待协议</font> P75

> 源站发送单个帧后必须等待确认，在此期间不能发送其他的数据帧
>
> 除数据丢失外，还有可能出现 到达目的站的帧已遭破坏、数据帧正确而确认帧被破坏
>
> 为了超时重发和判定重复帧，发送方和接收方都需设置一个帧缓冲区，只有收到对方发来的确认帧ACK时，才可清除副本

### 3.4.3 <font color=#3CB371 title='0,4'>多帧滑动窗口和后退N帧协议</font> （<font color=#800000 title='0,4'>GBN</font>）

> 接收方只允许顺序接收帧（第N帧前一个帧未能超时前返回确认帧，发送方需要重传该帧和随后的N帧）
>
> 累积确认
>
> 接收窗口为1，若采用n比特对帧编号，发送窗口 $W_T $ 应满足 $ 1 \leq W_T \leq {2^n}-1$  ,否则无法分辨新帧和旧帧 P130
>
> 连续发送数据提高了信号利用率、原来正确的数据帧重传致使传送率降低；若信道传输质量差导致误码率高时，不一定优于停等协议

### 3.4.4 <font color=#3CB371 title='0,2'>多帧滑动窗口与选择重传协议</font> <font color=#800000 title=''>SR</font>

> 收下发送序号不连续但仍处在接收窗口的数据帧
>
> 若采用n比特对帧编号，需要满足 $ 接收窗口 W_R + 发送窗口 W_T \leq {2^n} $ ，接收窗口不应大于发送窗口，即 $ W_R \leq {2^{n-1}} $ ；一般情况下，SR协议中接收窗口发送窗口大小相等，缓冲区的数目等于窗口大小

<font color=#3CB371 title='0,2'>信道利用率</font> 发送方在一个发送周期内，有效发送数据需要时间占整个发送周期的比率

> 发送方从开始发送数据到收到第一个确认帧为止，称为一个  <font color=#3CB371 title='0,0'>发送周期</font> ，设为T，发送方在周期内发送L比特数据，发送方传输速率为C，则信道利用率为 $ \frac { \frac {L} {C} } {T} $
>
> <font color=#FFA07A title='0,0'>信道吞吐率=信道利用率*发送方发送速率</font>



## 3.5 介质访问控制

> 主要任务是为使用介质的每个结点隔离来自同一信道上其他结点所传送的信号，协调活动结点的传输
>
> 用来决定广播信道中信道分配的协议属于数据链路层的<font color=#3CB371 title='0,0'>介质访问控制</font> <font color=#800000 title='0,0'>MAC</font> 子层
>
> 内容是采取一定措施，使得两对结点之间的通信不会相互干扰
>
> 常见的控制方法有
>
> > <font color=#3CB371 title='0,1'>静态划分信道 </font> 信道划分介质控制
> >
> > <font color=#3CB371 title='-1,0'>动态划分信道</font> 随机访问介质访问控制、轮询访问介质访问控制
> >
> > > ### 3.5.1 <font color=#3CB371 title='0,17'>信道划分介质控制</font> 
> > >
> > > > 使用介质的每个设备与来自同一通信信道上的其他设备的通信隔离开，把时域和频域合理的分配给网络设备
> > > >
> > > > <font color=#3CB371 title='0,1'>多路复用技术</font> 把多个信号组合在一条物理信道进行传输，使多个计算机设备共享信道资源，提高信道利用率
> > > >
> > > > $ N个输入——（多路复用器）—— 1条链路，N个信道 —— （多路复用器）——N个输出$
> > > >
> > > > > <font color=#3CB371 title='0,3'>频分多路复用</font> <font color=#800000 title='0,3'>FDM</font> P86
> > > > >
> > > > > > 是一种将多路基带信号调制到不同频率载波上，再叠加形成一个符合信号的多路复用技术
> > > > > >
> > > > > > 每个子信道带宽可不相同，但总和不能超过总带宽
> > > > > >
> > > > > > 充分利用了介质的带宽，效率较高；技术较成熟，实现也容易
> > > > >
> > > > > <font color=#3CB371 title='0,2'>时分多路复用</font> <font color=#800000 title='0,2'>TDM</font> P86
> > > > >
> > > > > > 将一条物理信道按时间分成若干时间片，轮流分配给多个信号使用
> > > > > >
> > > > > > <font color=#3CB371 title='0,0'>统计时分多路复用、异步时分多路复用</font> <font color=#800000 title='0,0'>STDM</font> 采用STDM帧，按需动态分配时隙
> > > > >
> > > > > <font color=#3CB371 title='0,1'>波分多路复用</font> <font color=#800000 title='0,1'>WDM</font> P86
> > > > >
> > > > > > 即 <font color=#3CB371 title='-1,0'>光的频分多路复用</font> ，在一根光纤中传输多种不同波长的光信号，再用波长分解复用器将各路波长分解出来
> > > > >
> > > > > <font color=#3CB371 title='0,4'>码分多路复用</font> <font color=#800000 title='0,4'>CDM</font>
> > > > >
> > > > > > 采用不同的编码区分各路原始信号的复用方式
> > > > > >
> > > > > > 更常用的名词是 <font color=#3CB371 title='-2,2'>码分多址</font> <font color=#800000 title='-2,2'>CDMA</font> ，原理是每个比特时间再划分成m个短的时间槽，称为 <font color=#3CB371 title='0,0'>码片</font>
> > > > > >
> > > > > > <font color=#FFA07A title='0,0'>CDMA的原理</font> P87
> > > > > >
> > > > > > 频谱利用率高、抗干扰能力强、保密性强、语音质量好等优点，还可以减少投资和降低运行成本，主要用于无线电通信系统，特别是移动通信系统
> > >
> > > ### 3.5.2 <font color=#3CB371 title='0,56'>随机访问介质访问控制</font>
> > >
> > > > 不采用集中控制方式解决发送信息次序的问题，所有用户能更具自己的意愿随机发送信息，占用信道全部速率
> > > >
> > > > 又称 <font color=#3CB371 title='-1,0'>争用型协议</font>
> > > >
> > > > <font color=#3CB371 title='0,7'>ALOHA协议</font>
> > > >
> > > > > <font color=#3CB371 title='0,3'>纯ALOHA协议</font>
> > > > >
> > > > > > 可以不进行任何检测就发送数据
> > > > > >
> > > > > > 出现碰撞的重传策略是等待一段随机的时间再进行重传
> > > > > >
> > > > > > 吞吐量很低
> > > > >
> > > > > <font color=#3CB371 title='0,2'>时隙ALOHA</font>
> > > > >
> > > > > > 把所有各站在时间上同步起来，将时间划分为一段段等长的时隙，规定只能在每个时隙开始才能发送一个帧
> > > > > >
> > > > > > 重传策略与纯ALOHA一致
> > > >
> > > > <font color=#3CB371 title='0,45'>载波侦听多路访问</font> <font color=#800000 title='0,45'>CSMA</font>
> > > >
> > > > > 先侦听共用信道，发现空闲后再发送
> > > > >
> > > > > ><font color=#3CB371 title='0,3'>1-坚持 CSMA</font>
> > > > > >
> > > > > >> 先侦听信道，空闲则立即发，非空闲则等待且继续监听直至信道空闲
> > > > > >>
> > > > > >> 发生冲突则随机等待一段时间再重新开始监听
> > > > > >>
> > > > > >> 传播延迟对其性能影响较大
> > > > > >
> > > > > ><font color=#3CB371 title='0,2'>非坚持 CSMA</font>
> > > > > >
> > > > > >> 先侦听信道，空闲则立即发，非空闲则放弃监听，等待一个随机事件重复上述过程
> > > > > >>
> > > > > >> 降低冲突概率，但也增加了数据平均延迟
> > > > > >
> > > > > ><font color=#3CB371 title='0,3'>p-坚持 CSMA</font>
> > > > > >
> > > > > >> 先侦听信道，信道忙就继续侦听，直至空闲
> > > > > >>
> > > > > >> 如果信道空闲，则以概率p发送，概率1-p推迟到下一个时隙
> > > > > >>
> > > > > >> 过程持续到数据发送成功或因其他结点检测到信道忙为止，后者则等待一个时间间隙重新监听
> > > > >
> > > > > <font color=#3CB371 title='0,11'>载波侦听多路访问/碰撞检测协议</font>  <font color=#800000 title='0,11'>CSMA/CD</font>
> > > > >
> > > > > > 适用于<font color=#239080 title='-1,0'>总线型或半双工网络</font>
> > > > > >
> > > > > > <font color=#3CB371 title='0,0'>载波侦听</font> 指发送前要检测是否有其他站点发送数据
> > > > > >
> > > > > > <font color=#3CB371 title='0,0'>碰撞检测</font> 适配器边发送数据边检测信道上信号电压的变化，判断其他站点是否也在发送
> > > > > >
> > > > > > 先听后发，边听边发，冲突停发，随机重发
> > > > > >
> > > > > > 采用协议的以太网只能进行半双工通信，把以太网端到端往返时间 $ 2\tau （\tau 为传播时延） $称为<font color=#3CB371 title='0,0'>争用期 冲突窗口或碰撞窗口</font>
> > > > > >
> > > > > > <font color=#FFA07A title='0,0'>CSMA/CD 最小帧长=总线传播时延 * 数据传输速率 * 2</font>
> > > > > >
> > > > > > 采用<font color=#FFA07A title='0,4'>二进制指数退避算法</font>解决碰撞问题
> > > > > >
> > > > > > > 确定基本退避时间，一般取传播时延两倍$2 \tau$（即 <font color=#239080 title='0,0'>争用期</font> ）
> > > > > > >
> > > > > > > 确定参数k，k为重传次数，$ k=min[重传次数，10] $ 
> > > > > > >
> > > > > > > 从离散整数集合$ [0,1,2···,2^{k}-1]$ 随机取出一个数 r ，重传退避时间就是 $2 r \tau$
> > > > > > >
> > > > > > > 重传16次仍不成功时，说明网络过于拥挤，抛弃此帧并向高层报告出错
> > > > >
> > > > > <font color=#3CB371 title='0,16'>载波侦听多路访问/碰撞避免协议</font>  <font color=#800000 title='0,16'>CSMA/CA</font>
> > > > >
> > > > > > 无线局域网使用
> > > > > >
> > > > > > > 接收信号强度往往远小于发送强度，且无线介质上信号强度动态变化范围很大，实现碰撞检测成本高
> > > > > > >
> > > > > > > 并非所有站点都能听见对方，存在“隐蔽站”
> > > > > >
> > > > > > <font color=#239080 title='0,5'>802.11</font>
> > > > > >
> > > > > > > 使用链路层确认/重传方案
> > > > > > >
> > > > > > > 所有站完成发送后必须等待一段很短的时间才能发下一帧，这个时间称为<font color=#3CB371 title='0,3'>帧间间隔</font> <font color=#800000 title='0,3'>IFS</font>，802.11使用三种IFS
> > > > > > >
> > > > > > > > <font color=#800000 title='0,0'>SIFS</font> <font color=#3CB371 title='0,0'>短IFS</font> 最短的IFS，使用的类型有<font color=#800000 title='0,0'>ACK、CTS</font> 帧，分片后的数据帧，所有回答<font color=#800000 title='0,0'>AP</font>探寻的帧等
> > > > > > > >
> > > > > > > > <font color=#800000 title='0,0'>PIFS</font> <font color=#3CB371 title='0,0'>点协调IFS</font> 中等长度，在<font color=#800000 title='0,0'>PCF</font>操作使用
> > > > > > > >
> > > > > > > > <font color=#800000 title='0,0'>DIFS</font> <font color=#3CB371 title='0,0'>分布式协调IFS</font> 最长，用于异步帧竞争访问的时延
> > > > > >
> > > > > > 算法归纳
> > > > > >
> > > > > > > * 若站点最初有数据需要发送，且检测到信道空闲，等待时间DIFS后，发送整个数据帧
> > > > > > > * 否则执行CSMA/CA，选取一个随机回退值
> > > > > > > * 退避器减到0时，发送整个帧并等待确认
> > > > > > > * 发送站若收到确认，如有第二帧，从第二步开始
> > > > > > > * 若规定时间内没有收到确认帧，就必须重传该帧，失败若干次后放弃发送
> > > > > >
> > > > > > <font color=#239080 title='0,0'>处理隐蔽站问题</font> P93
> > > > >
> > > > > <font color=#FF0000 title='0,3'>CSMA/CD与CSMA/CA主要区别</font> P94
> > > > >
> > > > > > CSMA/CD 可以检测冲突但无法避免；CSMA/CA不能检测有无冲突
> > > > > >
> > > > > > 传输介质不同
> > > > > >
> > > > > > 检测方式不同
> > >
> > > ### 3.5.3 <font color=#3CB371 title='0,4'>轮询访问介质访问控制：令牌传递协议</font> P94
> > >
> > > > 用户不能随机发送信息，需要通过一个集中控制的监控站，以循环方式轮询每个结点，再决定信道分配
> > > >
> > > > 典型的就是令牌传递协议，主要用在令牌环局域网中
> > > >
> > > > 非常适合负载很高的广播信道（多个结点同一时刻发送数据概率很大的信道）
> > > >
> > > > 既不共享时间，也不共享空间，实际上是在随机介质访问控制的基础上，限定了有权利发送数据的数据结点只能有一个



## 3.6 局域网

### 3.6.1 局域网的基本概念和体系结构 P103

> <font color=#3CB371 title='0,5'>局域网</font> <font color=#800000 title='0,5'>LAN</font> 是指一个较小的地理范围将各种计算机、外部设备和数据库系统等通过双绞线、同轴电缆等连接介质互相连接起来，组成资源和信息共享的计算机互联网络
>
> > * 为一个单位所拥有，地理范围和站点数目均有限
> > * 所有站点共享较高的总带宽
> > * 较低的时延和较低的误码率
> > * 各站为平等关系而非主从关系
> > * 能进行广播和组播
>
> <font color=#3CB371 title='0,17'>局域网特性</font> 主要由拓扑结构、传输介质、介质访问控制方式决定
>
> > <font color=#3CB371 title='0,4'>局域网拓扑结构</font>
> >
> > * 星形结构
> > * 环形结构
> > * 总线型结构
> > * 星形和总线型结合的复合型结构
> >
> > <font color=#3CB371 title='0,2'>局域网传输介质</font>
> >
> > > 双绞线、铜缆和光纤等，双绞线为主流介质
> >
> > <font color=#3CB371 title='0,3'>局域网介质访问控制方法</font>
> >
> > > <font color=#239080 title='-1,1'>总线型局域网</font> CSMA/CD、令牌总线
> > >
> > > <font color=#239080 title='-2,0'>环形局域网</font>  令牌环
> >
> > <font color=#3CB371 title='0,3'>局域网拓扑实现</font>
> >
> > > <font color=#239080 title='0,0'>以太网</font> 目前使用最广的局域网，逻辑拓扑是总线型，物理拓扑时星形或拓展星形结构
> > >
> > > <font color=#239080 title='0,0'>令牌环</font> <font color=#800000 title='0,0'>IEEE 802.8</font> 逻辑拓扑是环形结构，物理拓扑是星星结构
> > >
> > > <font color=#3CB371 title='0,0'>光纤分布数字接口</font> <font color=#800000 title='0,0'>IEEE 802.8</font> 逻辑拓扑是环形结构，物理拓扑是双环结构
> >
> > <font color=#800000 title='0,2'>IEEE 802</font> 标准定义的局域网参考模型对应于 <font color=#239080 title='0,2'>OSI参考模型</font> 的数据链路层和物理层，并将数据拆分成两个子层
> >
> > > <font color=#3CB371 title='0,0'>逻辑链路控制子层</font> <font color=#800000 title='0,0'>LLC</font> 与传输媒体无关，向网络层提供无确认连接、面向连接、带确认无连接、高速传送四种不同的连接服务类型;建立和释放数据链路层的逻辑连接、提供与高层的接口、差错控制、给帧加序号
> > >
> > > <font color=#3CB371 title='0,0'>媒体接入控制子层</font> <font color=#800000 title='0,0'>MAC</font> 存放与接入传输媒体有关的内容，向上层屏蔽物理层访问的各种差异，提供对物理层的统一访问接口，主要功能包括：组帧、拆卸帧、比特传输差错检测、透明传输，竞争处理；

### 3.6.2 以太网与IEEE 802.3 P105

> <font color=#800000 title='0,0'>IEEE 802.3</font> 是一种基带总线型的局域网标准，描述物理层和数据链路层的MAC子层的实现方法，通常将IEEE 802.3局域网称为<font color=#3CB371 title='0,22'>以太网</font>
>
> > 以太网采用无连接的工作方式
> >
> > 发送的数据都使用曼彻斯特编码的信号
> >
> > <font color=#3CB371 title='0,3'>以太网的传输介质与网卡</font> 
> >
> > > 常用传输介质有：粗缆、细缆、双绞线和光纤
> > >
> > > <font color=#3CB371 title='0,0'>各种传输介质的适用情况</font> P105
> > >
> > > 计算机与外界局域网的连接是通过主机内的<font color=#239080 title='0,0'>网络接口板 网络适配器 网络接口卡</font> <font color=#800000 title=''>NIC</font> 实现的，全世界的每块网卡都有唯一的代码，称为 <font color=#3CB371 title='0,0'>介质访问控制地址</font> <font color=#800000 title='0,0'>MAC</font> ；数据链路层设备（网桥、交换机）都适用网卡的MAC地址
> >
> > <font color=#3CB371 title='0,4'>以太网的MAC地址</font>
> >
> > > 每块网卡中的MAC地址也称 <font color=#3CB371 title='0,0'>物理地址</font>
> > >
> > > MAC地址长6字节
> > >
> > > 以太网MAC帧格式有两种标准
> > >
> > > > <font color=#3CB371 title='-1,0'>以太网V2标准</font> <font color=#800000 title='-1,0'>DIX Ethernet V2</font> P105 和 <font color=#800000 title='-1,0'>IEEE 802.3</font>
> >
> > <font color=#3CB371 title='0,10'>高速以太网</font>
> >
> > > <font color=#3CB371 title='0,2'>100BASE-T 以太网</font>
> > >
> > > > 在双绞线上传送100Mb/s基带信号的星形拓扑结构以太网使用CSMA/CD协议
> > > >
> > > > 支持全双工 半双工，全双工无冲突发生，因此不使用CSMA/CD
> > >
> > > <font color=#3CB371 title='0,1'>吉比特以太网</font>
> > >
> > > > 又称<font color=#3CB371 title='0,0'>千兆以太网</font>，使用802.3协议规定的帧协议，允许在1Gb/s下用全双工和半双工两种方式工作，半双工使用CSMA/CD，与10BASE-T和100BASE-T技术向后兼容
> > >
> > > <font color=#3CB371 title='0,3'>10吉比特以太网</font>
> > >
> > > > 保留了802.3标准规定的以太网最小和最大的帧长，便于升级
> > > >
> > > > 不使用铜线而只使用光纤作为传输媒体
> > > >
> > > > 只工作在全双工方式
> >
> > <font color=#239080 title='0,0'>以太网</font> 可拓展、灵活，易于安装，稳健型好

### 3.6.3 <font color=#3CB371 title='0,8'>IEEE 802.11</font> P107

> <font color=#3CB371 title='0,4'>有固定基础设施无线局域网</font>
>
> > 802.11 使用星形拓扑，其中心称为<font color=#3CB371 title='0,0'>接入点</font> <font color=#800000 title='0,0'>AP</font>，在 <font color=#800000 title='0,0'>MAC</font> 层使用 <font color=#800000 title='0,0'>CSMA/CA</font> 协议，使用802.11系列协议的局域网又称<font color=#800000 title='0,0'>Wi-Fi</font>
> >
> > 802.11协议标准规定无线局域网最小构建是<font color=#3CB371 title='0,2'>基本服务集</font> <font color=#800000 title='0,2'>BBS</font>
> >
> > > 一个基本服务集包括一个基站和若干移动站，<font color=#800000 title='0,0'>AP</font> 就是基本服务集中的基站
> > >
> > > 一个基本服务集可以是独立的，也可以通过<font color=#800000 title='0,0'>AP</font>连接到一个 <font color=#239080 title='0,0'>分配系统</font> <font color=#800000 title='0,0'>DS</font> ，然后连接到另一个基本服务集，构成一个 <font color=#239080 title='0,0'>拓展的服务集</font> <font color=#800000 title='0,0'>ESS</font> （A从一个基本服务集到另一个，仍可以保证和一个移动站B的通信，但A在不同基本服务集使用的AP改变了）
>
> <font color=#3CB371 title='0,2'>无固定基础设施移动自组织网络</font>
>
> > 自足网络没有<font color=#800000 title='0,0'>AP</font> ，而是由一些平等状态的移动站互相通信组成的临时网络
> >
> > 自足网络和移动IP不相同，移动IP技术使漫游的主机可以用多种方法连接因特网，自组网络是把移动性拓展到无线领域中的自治系统

### 3.6.4 <font color=#3CB371 title='0,8'>令牌环网的基本原理</font> P109

> 环网每一站通过电缆与 <font color=#239080 title='0,3'>环接口干线耦合器</font> <font color=#800000 title='0,3'>TCU</font>相连
>
> > TCU 用于传递所有经过的帧、为接入站发送和接收数据提供接口
> >
> > TCU 有收听状态和发送状态
> >
> > 数据总是在某个特定方向上从一个TCU到下一个TCU逐比特依次传送
>
> <font color=#3CB371 title='0,3'>令牌环网的媒体接入机制</font>采用的是分布式控制模式的循环方法
>
> > 令牌环网中有一个令牌沿着环形总线在入网结点计算机依次传递，令牌实际上是一个特殊的MAC控制帧，仅控制信号的使用，确保一个时刻只有一个结点能够独占信道，因此不会发生碰撞
> >
> > 对于所有入网计算机而言，访问权是公平的
> >
> > 物理上采用星形拓扑，逻辑上仍是环形拓扑



## 3.7 广域网

### 3.7.1 <font color=#3CB371 title='0,6'>广域网的基本概念</font> P114

> 广域网通常指覆盖范围很广的长距离网络
>
> 广域网由一些<font color=#239080 title='0,0'>结点交换机</font> 及连接这些交换机的链路组成，结点交换机的功能是将分组存储转发
>
> 广域网使用的协议主要在网络层
>
> 广域网一个重要的问题是路由选择与分组转发
>
> > <font color=#3CB371 title='-1,0'>路由选择</font> 搜索分组从某个结点到目的结点的最佳传输路由，以便构造出路由表，根据路由表再构造转发分组的转发表
>
> <font color=#800000 title='0,0'>PPP</font> 协议和 <font color=#800000 title='0,0'>HDLC</font> 协议是目前最常用的两种广域网数据链路层控制协议

<font color=#FF0000 title='0,0'>广域网与局域网的区别和联系</font> P115

### 3.7.2 <font color=#3CB371 title='0,12'>PPP协议</font> P115

> PPP协议是使用串行线路通信的<font color=#FF0000 title='0,0'>面向字节</font>的协议
>
> PPP协议在 <font color=#800000 title='0,0'>SLIP</font> 协议基础上发展而来，既可以在异步线路上传输，又可以在同步线路上使用
>
> PPP协议由三个部分组成
>
> > <font color=#3CB371 title='0,0'>链路控制协议</font> <font color=#800000 title='0,0'>LCP</font> 用于建立、配置、测试和管理数据链路
> >
> > <font color=#3CB371 title='0,0'>网络控制协议</font> <font color=#800000 title='0,0'>NCP</font> PPP协议允许同时采用多种网络层协议，每个不同的网络层协议要用一个相应的NCP配置，为网络层协议建立和配置逻辑连接
> >
> > 一个将IP数据包封装到串行链路的方法
>
> PPP是面向字节的，所有的PPP帧长度都是整数个字节
>
> 提供差错检测但不提供纠错功能
>
> 仅支持点对点的链路通信，不支持多点线路
>
> 只支持全双工链路
>
> PPP两端可以运行不同的网络层协议
>
> 若PPP在异步线路（默认），采用字节填充法；用在同步线路，协议规定采用硬件完成比特填充

### 3.7.3 <font color=#3CB371 title='0,18'>HDLC协议</font> P117

> <font color=#3CB371 title='-1,17'>高级数据链路控制协议</font> 是ISO制定的<font color=#FF0000 title='0,0'>面向比特</font>的协议
>
> 不依赖任何一种字符编码集
>
> 数据报文可透明传输，用于实现透明传输的“0比特插入法”易于硬件实现
>
> 全双工通信，有较高的数据链路传输效率
>
> 所有帧采用CRC检验，对信息帧进行顺序编号，可防止漏收或重发，传输可靠性高
>
> 传输控制功能与处理功能分离，灵活性大
>
> 适用链路的两种基本配置
>
> > <font color=#3CB371 title='-1,1'>非平衡配置</font> 由一个主站控制整个链路工作
> >
> > <font color=#3CB371 title='-2,0'>平衡配置</font> 链路两端都是复合站，可以平等的发起数据传输
>
> <font color=#3CB371 title='0,3'>站</font>
>
> > <font color=#3CB371 title='0,0'>主站</font> 发出的帧称为<font color=#3CB371 title='0,0'>命令帧</font> 
> >
> > <font color=#3CB371 title='0,0'>从站</font> 从站受控于主站，发出的帧称为<font color=#3CB371 title='0,0'>响应帧</font>
> >
> > <font color=#3CB371 title='0,0'>复合站</font> 具有主站的功能，又具有从站的功能
>
> <font color=#3CB371 title='0,3'>数据操作方式</font>
>
> > <font color=#3CB371 title='0,0'>正常响应方式</font> 非平衡 主站向从站传输数据，从站响应数据，但从站只有收到主站许可后，才可进行响应
> >
> > <font color=#3CB371 title='0,0'>异步平衡方式</font> 平衡 每个复合站都可以进行对另一站的数据传输
> >
> > <font color=#3CB371 title='0,0'>异步响应方式</font> 非平衡 从站未受到主站允许，也可以进行传输
>
> <font color=#3CB371 title='0,0'>HDLC帧</font> P117

<font color=#FF0000 title='0,4'>PPP协议与HDLC的差异</font>

> PPP协议面向字节，HDLC面向比特
>
> PPP帧比HDLC帧多一个2字节的协议字段
>
> PPP协议不使用序号和确认机制，只保证无差错接收，端到端差错检测由高层协议负责
>
> HDLC协议信息帧使用了编号和确认机制，能提供可靠传输



## 3.8 数据链路层的设备

### 3.8.1 <font color=#3CB371 title='0,40'>网桥的概念及其基本原理</font> P121

> 网桥处理的数据对象是帧，它是工作在数据链路层的设备
>
> 基本特点
>
> > * 网桥必须具备寻址和路径选择，确定帧的传输方向
> >
> > * 从源网络接收帧，以目的网络的介质访问控制协议向目的网络转发该帧
> > * 网桥在不同或相同类型的LAN之间存储并转发帧，必要时还进行链路层上的协议转换
> > * 网桥对接收到的帧不作任何修改，只对封装格式做很少修改
> > * 网桥可以通过执行帧翻译互联不同类型的局域网
> > * 网桥应有足够大的缓冲空间，因为短时间帧的到达速率可能远高于转发速率
> > * 必须具有路径选择的功能
>
> 优点
>
> > * 能过滤通信量
> > * 扩大了物理范围
> > * 可使用不同的物理层
> > * 可互联不同类型的局域网
> > * 提高了可靠性
> > * 性能得到了改善
>
> 缺点
>
> > * 增大了时延
> >
> > * MAC 子层没有流量控制功能
> >
> > * 不同MAC子层的网段桥接在一起时，需要进行帧格式的转换
> >
> > * 网桥只适合于用户数不多的、通信量不大的局域网
> >
> > * 会发生广播风暴
> >
> >   > <font color=#3CB371 title='0,0'>广播风暴</font> 过多的广播信息造成网络拥塞
>
> <font color=#3CB371 title='0,17'>网桥路径选择算法</font> 
>
> > <font color=#3CB371 title='0,6'>透明网桥</font>
> >
> > > 选择的不是最佳路由
> > >
> > > 到达帧的路由选择过程取决于源LAN和目的LAN
> > >
> > > > 如果源LAN和目的LAN相同，丢弃该帧
> > > >
> > > > 如果源LAN和目的LAN不同，转发该帧
> > > >
> > > > 如果目的LAN未知，扩散该帧
> > >
> > > 透明网桥使用了一种生成树算法，以确保每个源到目的地支有唯一的路径，但一般不是最佳路由
> >
> > <font color=#3CB371 title='0,6'>源路由网桥</font>
> >
> > > 选择的是最佳路由
> > >
> > > 路由选择由发送数据帧的源站负责，网桥只根据真正的路由信息对帧进行接收和转发
> > >
> > > > 源站以广播方式向目的站发送一个发现帧作为探测
> > > >
> > > > 源站通过应答帧选择最佳路由
> > > >
> > > > 凡是从该源站发往该目的站的帧的首部，必须携带这个路由信息
> > >
> > > 发现帧数量指数式增加，可能导致网络严重堵塞
> >
> > <font color=#3CB371 title='0,2'>两种网桥的比较</font>
> >
> > > 使用源路由网桥可以利用最佳路由，若在两个以太网之间使用并联的路由网桥，还可以是通信量较平均的分配给每个网桥
> > >
> > > 使用透明网桥时，只能使用生成树，一般不保证所使用的路由是最佳的，也不能在不同链路中做负载均衡

### 3.8.2 <font color=#3CB371 title='0,16'>局域网交换机及其工作原理</font> P123

> 又称<font color=#3CB371 title='-1,15'>以太网交换机</font>
>
> 是一个多端口的网桥，工作在数据链路层
>
> 能将网络分成小的冲突域
>
> 局域网交换机可以方便地实现<font color=#239080 title='0,0'>虚拟局域网</font> <font color=#800000 title='0,0'>VLAN</font>，VLAN不仅可以隔离冲突域，还可以隔离广播域
>
> <font color=#3CB371 title='0,1'>以太网交换机原理</font>
>
> > 检测以太端口来的数据帧的源和目的地的MAC地址，与系统内部的动态查找表比较，若数据帧的MAC地址不再查找表中，则将该地址加入查找表，并将数据帧发送到相应的目的端口
>
> <font color=#3CB371 title='0,6'>以太网交换机特点</font>
>
> > * 每个端口都直接与单台主机相连，一般工作在全双工方式
> >
> > * 能同时连接许多对端口，相互通信的主机都可以无碰撞的传输数据
> >
> > * 是一种即插即用设备，内部转发表也是自学习算法自动建立的
> >
> > * 使用了专用的交换结构芯片，交换速率较高
> >
> > * 独占传输媒体带宽
> >
> >   > 若N个用户使用带宽为G的网络，传统共享式以太网每个用户平均带宽只有 $ \frac {G}{N} $，使用以太网交换机时，拥有N个端口的交换机总容量为 G*N
>
> <font color=#3CB371 title='0,2'>两种交换模式</font>
>
> > <font color=#3CB371 title='0,0'>直通式交换机</font> 只检查帧的目的地址，速度快，但缺乏智能型和安全性，也无法支持具有不同速率的端口的交换
> >
> > <font color=#3CB371 title='0,0'>存储转发式交换机</font> 将接收到的帧缓存到高速缓存器中，并检查数据是否正确，优点是可靠性高，并能支持不同速率端口间的转换，缺点是延迟较大
